<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profil Saya | SnapLoop</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="form-container">
    <img src="assets/images/logo.png" alt="SnapLoop Logo" class="logo" />
    <h2>My Photos</h2>

    <div id="photoGallery" class="user-gallery" style="margin-top: 20px;"></div>

    <br>
    <a href="upload.html" class="yellow-btn">Upload Foto Baru</a>
    <br><br>
    <button id="logoutBtn">Logout</button>
  </div>

  <script>
    const BASE_URL = "http://54.83.131.137";
    const token = localStorage.getItem("token");

    if (!token) {
      alert("Silakan login terlebih dahulu.");
      window.location.href = "index.html";
    }

    fetch(`${BASE_URL}/users/me`, {
      headers: { Authorization: `Bearer ${token}` }
    })
    .then(res => res.json())
    .then(user => {
      fetch(`${BASE_URL}/photos/${user.id}`)
        .then(res => res.json())
        .then(photos => {
          const gallery = document.getElementById("photoGallery");
          if (photos.length === 0) {
            gallery.innerHTML = "<p>Belum ada foto.</p>";
          } else {
            photos.forEach(photo => {
              const img = document.createElement("img");
              img.src = `${BASE_URL}/${photo.url}`;
              img.style.width = "150px";
              img.style.margin = "10px";
              img.style.borderRadius = "8px";
              gallery.appendChild(img);
            });
          }
        });
    });

    document.getElementById("logoutBtn").addEventListener("click", () => {
      localStorage.removeItem("token");
      window.location.href = "index.html";
    });
  </script>
</body>
</html>
